{"version":3,"sources":["OwO.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","OwO","option","_this","this","defaultOption","logo","container","document","getElementsByClassName","getElementsByTagName","position","type","width","maxHeight","api","defaultKey","hasOwnProperty","classList","add","xhr","XMLHttpRequest","onreadystatechange","readyState","status","odata","JSON","parse","responseText","init","console","log","open","send","value","_this2","area","packages","keys","html","parseInt","opackage","text","icon","innerHTML","addEventListener","toggle","e","contains","parentNode","cursorPos","selectionEnd","areaValue","imgUrl","querySelector","slice","getAttribute","focus","packagesEle","_loop","index","children","tab","remove","itemsShow","packageActive","module","exports","window"],"mappings":"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","file":"OwO.min.js","sourcesContent":["(() => {\r\n    class OwO {\r\n        constructor(option) {\r\n            const defaultOption = {\r\n                logo: 'OwO表情',\r\n                container: document.getElementsByClassName('OwO')[0],\r\n                target: document.getElementsByTagName('textarea')[0],\r\n                position: 'down',\r\n                type: 'data-src',\r\n                width: '100%',\r\n                maxHeight: '250px',\r\n                api: 'https://api.anotherhome.net/OwO/OwO.json'\r\n            };\r\n            for (let defaultKey in defaultOption) {\r\n                if (defaultOption.hasOwnProperty(defaultKey) && !option.hasOwnProperty(defaultKey)) {\r\n                    option[defaultKey] = defaultOption[defaultKey];\r\n                }\r\n            }\r\n            this.container = option.container;\r\n            this.target = option.target;\r\n            this.type = option.type;\r\n            if (option.position === 'up') {\r\n                this.container.classList.add('OwO-up');\r\n            }\r\n\r\n            const xhr = new XMLHttpRequest();\r\n            xhr.onreadystatechange = () => {\r\n                if (xhr.readyState === 4) {\r\n                    if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {\r\n                        this.odata = JSON.parse(xhr.responseText);\r\n                        this.init(option);\r\n                    }\r\n                    else {\r\n                        console.log('OwO data request was unsuccessful: ' + xhr.status);\r\n                    }\r\n                }\r\n            };\r\n            xhr.open('get', option.api, true);\r\n            xhr.send(null);\r\n        }\r\n\r\n        init(option) {\r\n            this.area = option.target;\r\n            this.packages = Object.keys(this.odata);\r\n\r\n            // fill in HTML\r\n            let html = `\r\n            <div class=\"OwO-logo\"><span>${option.logo}</span></div>\r\n            <div class=\"OwO-body\" style=\"width: ${option.width}\">`;\r\n            \r\n            for (let i = 0; i < this.packages.length; i++) {\r\n\r\n                html += `\r\n                <ul class=\"OwO-items OwO-items-${this.odata[this.packages[i]].type}\" style=\"max-height: ${parseInt(option.maxHeight) - 53 + 'px'};\">`;\r\n\r\n                let opackage = this.odata[this.packages[i]].container;\r\n                for (let i = 0; i < opackage.length; i++) {\r\n\r\n                    html += `\r\n                    <li class=\"OwO-item\" title=\"${opackage[i].text}\">${opackage[i].icon}</li>`;\r\n\r\n                }\r\n\r\n                html += `\r\n                </ul>`;\r\n            }\r\n            \r\n            html += `\r\n                <div class=\"OwO-bar\">\r\n                    <ul class=\"OwO-packages\">`;\r\n\r\n                    for (let i = 0; i < this.packages.length; i++) {\r\n\r\n                        html += `\r\n                        <li><span>${this.packages[i]}</span></li>`\r\n\r\n                    }\r\n\r\n            html += `\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n            `;\r\n            this.container.innerHTML = html;\r\n\r\n            // bind event\r\n            this.logo = this.container.getElementsByClassName('OwO-logo')[0];\r\n            this.logo.addEventListener('click', () => {\r\n                this.toggle();\r\n            });\r\n\r\n            this.container.getElementsByClassName('OwO-body')[0].addEventListener('click', (e)=> {\r\n                let target = null;\r\n                if (e.target.classList.contains('OwO-item')) {\r\n                    target = e.target;\r\n                }\r\n                else if (e.target.parentNode.classList.contains('OwO-item')) {\r\n                    target = e.target.parentNode;\r\n                }\r\n                if (target) {\r\n                    const cursorPos = this.area.selectionEnd;\r\n                    let areaValue = this.area.value;\r\n                    let imgUrl =  target.querySelector('img');\r\n                    if(imgUrl){\r\n                        this.area.value = areaValue.slice(0, cursorPos) + `![${target.getAttribute(\"title\")}](${imgUrl.getAttribute(this.type)})` + areaValue.slice(cursorPos);\r\n                    }else{\r\n                        this.area.value = areaValue.slice(0, cursorPos) + target.innerHTML + areaValue.slice(cursorPos);\r\n                    }\r\n                    this.area.focus();\r\n                    this.toggle();\r\n                }\r\n            });\r\n\r\n            this.packagesEle = this.container.getElementsByClassName('OwO-packages')[0];\r\n            for (let i = 0; i < this.packagesEle.children.length; i++) {\r\n                ((index) =>{\r\n                    this.packagesEle.children[i].addEventListener('click', () => {\r\n                        this.tab(index);\r\n                    });\r\n                })(i);\r\n            }\r\n\r\n            this.tab(0);\r\n        }\r\n\r\n        toggle() {\r\n            if (this.container.classList.contains('OwO-open')) {\r\n                this.container.classList.remove('OwO-open');\r\n            }\r\n            else {\r\n                this.container.classList.add('OwO-open');\r\n            }\r\n        }\r\n\r\n        tab(index) {\r\n            const itemsShow = this.container.getElementsByClassName('OwO-items-show')[0];\r\n            if (itemsShow) {\r\n                itemsShow.classList.remove('OwO-items-show');\r\n            }\r\n            this.container.getElementsByClassName('OwO-items')[index].classList.add('OwO-items-show');\r\n\r\n            const packageActive = this.container.getElementsByClassName('OwO-package-active')[0];\r\n            if (packageActive) {\r\n                packageActive.classList.remove('OwO-package-active');\r\n            }\r\n            this.packagesEle.getElementsByTagName('li')[index].classList.add('OwO-package-active');\r\n        }\r\n    }\r\n    if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\r\n        module.exports = OwO;\r\n    }\r\n    else {\r\n        window.OwO = OwO;\r\n    }\r\n})();"]}